# 色块RPG游戏 - 重构版

从 Egret 引擎重构为纯 HTML/CSS/JavaScript 的色块RPG游戏。

## 游戏玩法

### 基础操作
点击屏幕上的色块进行交互，不同颜色代表不同功能。

### 色块类型

| 颜色 | 类型 | 说明 |
|------|------|------|
| 🔵 蓝色 | 任务 | 消耗ACT执行，获得金币和经验 |
| 🔴 红色 | 敌人 | 战斗获得金币、经验、钥匙 |
| 🟣 洋红色 | ATK商店 | 购买攻击力 |
| 🔵 青色 | DEF商店 | 购买防御力 |
| 🟢 绿色 | 生命回复 | 花费金币回复生命 |
| 🟠 橙色 | ACT上限 | 购买行动力上限 |
| 🔴 粉色 | LIFE上限 | 购买生命上限 |
| 🟤 棕色 | 宝箱 | 成就奖励 |
| 🟣 紫色 | 老虎机 | 40级解锁，赌博获取奖励 |
| ⬛ 灰色 | 钥匙商店 | 购买钥匙 |
| 🟣 深紫 | 属性点商店 | 购买可分配属性点 |
| 🔴 深红 | Boss | 完成全任务+全敌人后出现 |

### 属性系统

| 属性 | 说明 |
|------|------|
| LIFE | 生命值，被攻击减少，自动恢复 |
| ACT | 行动力，执行任务消耗，自动恢复 |
| ATK | 攻击力，影响对敌人伤害 |
| DEF | 防御力，减少受到伤害（上限300） |
| RPE | 回复力，影响所有属性恢复速度 |
| EXP | 经验值，升级获得3点属性点 |

### 钥匙系统

- 🔑 普通钥匙：解锁大型任务、敌人、商店物品
- 🔑2 高级钥匙：解锁特殊功能（生命回复、属性上限、属性点商店）

### 任务系统
- 点击蓝色任务块消耗ACT
- 进度条满后任务完成，获得1点属性点
- 完成后可继续点击征收金币
- 大型任务（面积>1000）需要钥匙解锁

### 战斗系统
- 点击红色敌人块进行攻击
- 敌人会反击造成伤害
- 伤害计算：`实际伤害 = 敌人伤害 × 0.5 × (1 - DEF/300)`
- 击败敌人获得金币、经验、钥匙
- 大型敌人（面积>1500）需要钥匙解锁
- 敌人会缓慢回血

### 商店系统
- ATK/DEF商店：每个最多购买9次，效果递减
- 生命回复：价格随等级和使用次数增加
- 属性上限：ACT/LIFE上限最高200
- 钥匙商店：固定价格400金币
- 属性点商店：购买可分配属性点

### 连击系统
- 连续收集物品增加连击数
- 连击时间窗口：45帧
- 最大连击数：120
- 达到最大连击触发成就

### 升级系统
- 升级所需经验：`100 + (等级-1)²`
- 升级获得3点可分配属性点
- 升级后生命和行动力完全恢复

### 成就系统（宝箱奖励）

| 成就 | 条件 | 奖励 |
|------|------|------|
| 全任务完成 | 完成所有任务 | 体力+20 |
| 全敌讨伐 | 击败所有敌人 | 回复x2 |
| 全物品购买 | 购买所有商店物品 | 行动+20 |
| 最大连击 | 连击达到120 | $200×等级 |
| NEKOGAMES | 收集全部9只猫 | 攻击x2 |

### 老虎机
- 40级自动解锁
- 花费10金币转动
- 点击停止转轮
- 三个相同符号获得奖励：
  - $$$ → 1600金币
  - @@@ → 200经验
  - 777 → 15540金币
  - *** → 9600金币

### Boss战
- 完成全任务+全敌人后出现
- 需要200+攻击力才能造成有效伤害
- 击败获得大量金币、经验和特殊猫

## 文件结构

```
├── index.html          # 主页面
├── style.css           # 样式
├── game.js             # 游戏主控制器
├── config.js           # 配置和消息
├── data.js             # 位置数据
├── utils.js            # 工具函数
├── classes/            # 游戏类
│   ├── Mission.js      # 任务
│   ├── Enemy.js        # 敌人
│   ├── ItemObj.js      # 掉落物品
│   ├── ShopItem.js     # 商店物品
│   └── SpecialItems.js # 特殊功能
└── src/                # 原始TypeScript源码
```

## 运行方法

```bash
# Python
python -m http.server 8000

# Node.js
npx http-server
```

访问 `http://localhost:8000`

## 技术实现

- HTML5 + CSS3 + JavaScript (ES6+)
- 60fps游戏循环
- 事件驱动架构
- 无需游戏引擎依赖

## 浏览器兼容

Chrome / Edge / Firefox / Safari / 移动端浏览器
